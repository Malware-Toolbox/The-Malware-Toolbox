using CommandLine;

namespace MalwareToolbox.ConsoleApp
{
    public class Commands
    {
        [Verb("regshot")]
        public class Regshot
        {
        }

        public abstract class FileCmd
        {
            [Option('f', "file", Required = true, HelpText = "File to get byte from")]
            public string File { get; set; }
        }

        [Verb("strings")]
        public class Strings : FileCmd
        {
            [Option('m', "min", Required = false, Default = 4, HelpText = "Minimum length of string")]
            public int Min { get; set; }
            
            [Option('M', "max", Required = false, Default = 1024, HelpText = "Maximum length of string")]
            public int Max { get; set; }
        }

        [Verb("peinfo")]
        public class PeInfo : FileCmd
        {
        }

        [Verb("packerid")]
        public class PackerId : FileCmd
        {
            [Option('d', "database", Required = true, HelpText = "Packer signature database file")]
            public string Database { get; set; }
        }

        [Verb("hash")]
        public class Hash : FileCmd
        {
            [Option('t', "type", Required = false, Default = "sha256", HelpText = "Hash type to use")]
            public string Type { get; set; }
        }
    }
}
