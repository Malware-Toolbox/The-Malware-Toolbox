using CommandLine;

namespace MalwareToolbox.ConsoleApp;

public class Commands
{
    public abstract class FileCmd
    {
        [Option('f', "file", Required = true, HelpText = "File to get byte from")]
        public string File { get; set; }
    }

    [Verb("hash")]
    public class Hash : FileCmd
    {
        [Option('t', "type", Required = false, Default = "sha256", HelpText = "Hash type to use")]
        public string Type { get; set; }
    }

    [Verb("peid")]
    public class Peid : FileCmd
    {
        [Option('d', "database", Required = true, HelpText = "Packer signature database file")]
        public string Database { get; set; }
    }

    [Verb("peinfo")]
    public class PeInfo : FileCmd
    {
    }

    [Verb("regshot")]
    public class Regshot
    {
    }

    [Verb("strings")]
    public class Strings : FileCmd
    {
        [Option('m', "min", Required = false, Default = 4, HelpText = "Minimum length of string")]
        public int Min { get; set; }

        [Option('M', "max", Required = false, Default = 1024, HelpText = "Maximum length of string")]
        public int Max { get; set; }

        [Option('s', "search", Required = false, Default = null, HelpText = "Search filter string")]
        public string Search { get; set; }
    }

    [Verb("virustotal")]
    public class VirusTotal
    {
        [Option('k', "apikey", Required = true, HelpText = "VirusTotal API key")]
        public string ApiKey { get; set; }

        [Option('h', "hash", Required = true, HelpText = "File hash")]
    public string Hash { get; set; }
    }

    [Verb("dnsreqcapture")]
    public class DNSReqCapture
    {
    }

    [Verb("processanalysis")]
    public class ProcessAnalysis
    {

    }
}
