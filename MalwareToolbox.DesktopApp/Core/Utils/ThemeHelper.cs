using MalwareToolbox.DesktopApp.Core.Configurations;
using Microsoft.UI.Xaml;

namespace MalwareToolbox.DesktopApp.Core.Utils;

public class ThemeHelper
{
    private readonly IConfigProvider _configProvider;

    public ThemeHelper()
    {
        _configProvider = App.Instance.ConfigProvider;
    }

    public void SetTheme(Application app)
    {
        var theme = _configProvider.GetConfig(Configs.ApplicationTheme);
        switch (theme)
        {
            case ElementTheme.Light:
                app.RequestedTheme = ApplicationTheme.Light;
                break;
            case ElementTheme.Dark:
                app.RequestedTheme = ApplicationTheme.Dark;
                break;
        }
    }

    public void SetTheme(Window window)
    {
        SetTheme((FrameworkElement)window.Content);
    }

    public void SetTheme(FrameworkElement element)
    {
        element.RequestedTheme = _configProvider.GetConfig(Configs.ApplicationTheme);
    }
}
