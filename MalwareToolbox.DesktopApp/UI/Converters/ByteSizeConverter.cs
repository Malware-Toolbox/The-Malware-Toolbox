using System;
using Microsoft.UI.Xaml.Data;

namespace MalwareToolbox.DesktopApp.UI.Converters;

public class ByteSizeConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, string language)
    {
        if (value is ulong bytes)
        {
            if (bytes < 1024)
            {
                return $"{bytes} bytes";
            }
            else if (bytes < 1048576)
            {
                return $"{decimal.Divide(bytes, 1024):.0000} KB";
            }
            else if (bytes < 1073741824)
            {
                return $"{decimal.Divide(bytes, 1048576):.0000} MB";
            }
            else if (bytes < 1099511627776)
            {
                return $"{decimal.Divide(bytes, 1073741824):.0000} GB";
            }
            else
            {
                return $"{decimal.Divide(bytes, 1099511627776):.0000} TB";
            }
        }

        return "";
    }

    public object ConvertBack(object value, Type targetType, object parameter, string language)
    {
        // ConvertBack is not implemented for a OneWay binding.
        throw new NotImplementedException();
    }
}
