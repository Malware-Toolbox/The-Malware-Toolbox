#pragma once
#include "Utils.h"

using namespace Collections::Generic;

namespace MalwareToolbox {
	namespace LibraryC {
		namespace Strings
		{
			public delegate bool StringCategoryMatcher(String^ str);

			public ref class StringCategoriser
			{
			public:
				StringCategoriser();

				void AddMatcher(String^ category_name, StringCategoryMatcher^ matchers);
				List <Tuple<String^, String^>^>^ CatergoriseStrings(List<String^>^ strings);
				String^ GetCategory(String^ str);

			private:
				List<Tuple<String^, StringCategoryMatcher^>^>^ m_matchers;
			};

			public ref class StringAnalyser
			{
			public:
				StringAnalyser(Utils::File^ file);

				List<String^>^ GenerateStrings(int minLength, int maxLength);

			private:
				Utils::File^ m_file;
			};
		}
	}
}
