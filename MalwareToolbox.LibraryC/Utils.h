#pragma once
#include "phnt_windows.h"

using namespace System;

namespace MalwareToolbox {
	namespace LibraryC {
		namespace Utils
		{
			namespace Converters
			{
				LPSTR cpp_string_to_lpstr(String^ value);
				LPWSTR cpp_string_to_lpwstr(String^ value);
				unsigned char* cpp_bytearray_to_char(array<Byte>^ value);

				String^ cs_schar_to_string(char* value);
				array<Byte>^ cs_char_to_bytearray(unsigned char* value, DWORD64 size);
			};

			public ref class File
			{
			public:
				File(String^ filePath);
				~File();
				virtual bool Load();
				virtual bool Unload();

				String^ GetPath();
				DWORD GetSize();
				BYTE GetByte(DWORD64 offset);
				unsigned char* GetData();
				bool IsLoaded();

			protected:
				String^ m_file_path;
				HANDLE m_file;
				DWORD m_file_size;
				LPVOID m_file_data;
				bool m_loaded;
			};
		}
	}
}
