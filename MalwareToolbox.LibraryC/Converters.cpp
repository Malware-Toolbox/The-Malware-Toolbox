#include "pch.h"
#include "Utils.h"

using namespace MalwareToolbox::LibraryC::Utils;
using namespace Runtime::InteropServices;

LPSTR Converters::cpp_string_to_lpstr(String^ value)
{
	return static_cast<LPSTR>(Marshal::StringToHGlobalAnsi(value).ToPointer());
}

LPWSTR Converters::cpp_string_to_lpwstr(String^ value)
{
	return static_cast<LPWSTR>(Marshal::StringToHGlobalUni(value).ToPointer());
}


unsigned char* Converters::cpp_bytearray_to_char(array<Byte>^ value)
{
	const pin_ptr<Byte> p = &value[0];
	return p;
}

String^ Converters::cs_schar_to_string(char* value)
{
	return gcnew String(value);
}

array<Byte>^ Converters::cs_char_to_bytearray(unsigned char* value, DWORD64 size)
{
	array<Byte>^ byte_array = gcnew array<Byte>(size);
	Marshal::Copy(safe_cast<IntPtr>(value), byte_array, 0, size);
	return byte_array;
}
