#pragma once
#include "phnt_windows.h"

using namespace System;
using namespace Collections::Generic;

namespace MalwareToolbox {
	namespace LibraryC {
		namespace Dynamic
		{
			public ref struct RegistryKeyMeta
			{
				DWORD SubKeysCount;
				DWORD MaxSubKeyNameSize;
				DWORD MaxClassSize;
				DWORD ValuesCount;
				DWORD MaxValueNameSize;
				DWORD MaxValueDataSize;
				DWORD SecurityDescriptorSize;
			};

			template<class T> public ref struct RegistryValue
			{
				String^ Name;
				DWORD Type;
				T Data;
			};

			public ref struct RegistryKey
			{
				RegistryKey^ ParentKey;
				String^ Name;
				RegistryKeyMeta^ Meta;
				Dictionary<String^, RegistryKey^>^ SubKeys;
				Dictionary<String^, RegistryValue<Object^>^>^ Values;
			};

			public ref class RegShot
			{
			public:
				RegistryKey^ TakeSnapshot();
			};
		}
	}
}
