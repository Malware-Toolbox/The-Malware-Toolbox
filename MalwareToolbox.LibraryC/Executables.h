#pragma once

#include <phnt_windows.h>

using namespace System;
using namespace Collections::Generic;

namespace MalwareToolbox {
	namespace LibraryC {
		namespace Executables
		{
			public ref class PE
			{
			public:
				static List<String^>^ KnownDlls();

				PE(String^ filePath);
				~PE();
				bool Load();
				bool Unload();
				void PrintProps();

				String^ GetPath() { return file_path_; }
				DWORD GetSize() { return file_size_; }
				BYTE GetByte(DWORD64 offset) { return *(BYTE*)((DWORD64)file_data_ + offset); }
				unsigned char* GetData() { return static_cast<unsigned char*>(file_data_); }
				bool IsLoaded() { return load_success_; }
			
			private:
				String^ file_path_;
				DWORD file_size_;
				LPVOID file_data_;
				bool load_success_;
			};
		}
	}
}
