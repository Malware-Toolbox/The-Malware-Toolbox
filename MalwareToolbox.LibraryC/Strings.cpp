#include "pch.h"
#include "Strings.h"
#include "Utils.h"

#include <ctype.h>
#include <iostream>

using namespace std;
using namespace System::Text;
using namespace MalwareToolbox::LibraryC::Strings;

StringAnalyser::StringAnalyser(Utils::File^ file) : m_file(file)
{
}

List<String^>^ StringAnalyser::GenerateStrings(int minLength, int maxLength)
{
	List<String^>^ strings = gcnew List<String^>();
	string str = "";
	for (DWORD i = 0; i < m_file->Size; i++)
	{
		if (isprint(m_file->Data[i]))
		{
			str += (char)(m_file->Data[i]);
			//cout << m_file->Data[i];
		}
		else
		{
			if (str.size() > minLength || str.size() > maxLength)
			{
				//cout << str << endl;
				strings->Add(gcnew String(str.c_str()));
			}
			str = "";
		}
	}

	return strings;
}
