#pragma once
#include "Executables.h"
#include "Utils.h"

using namespace Collections::Generic;

namespace MalwareToolbox {
	namespace LibraryC {
		namespace Unpackers
		{
			public value struct Signature
			{
				String^ Tool;
				List<Byte>^ SignatureValues;
				List<Byte>^ SignatureWildCards;
				bool IsEP;
			};

			public ref class PackerDatabase : public Utils::File
			{
			public:
				PackerDatabase(String^ filePath);
				~PackerDatabase();

				bool Load() override;
				static Signature ScanPE(Executables::PE File, bool hardcore);

				property List<Signature>^ Signatures { List<Signature>^ get(); }

			private:
				List<Signature>^ m_signatures;
			};
		}
	}
}
