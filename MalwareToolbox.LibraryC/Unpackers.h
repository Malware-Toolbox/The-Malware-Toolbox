#pragma once
#include "Executables.h"
#include "Utils.h"

using namespace Collections::Generic;

namespace MalwareToolbox {
	namespace LibraryC {
		namespace Unpackers
		{
			public enum class ScanMode
			{
				EpOnly,
				Default,
				Deep,
				Hardcore,
			};

			public ref struct Signature
			{
				String^ Tool;
				List<BYTE>^ SignatureValues;
				List<BYTE>^ SignatureWildCards;
				bool IsEP;
			};

			public ref class PackerDatabase : public Utils::WinFile
			{
			public:
				PackerDatabase(String^ filePath);
				~PackerDatabase();

				bool Load() override;
				List<Signature^>^ ScanPE(Executables::PE^ pe, ScanMode mode);

				property List<Signature^>^ Signatures { List<Signature^>^ get(); }

			private:
				List<Signature^>^ m_signatures;
			};
		}
	}
}
