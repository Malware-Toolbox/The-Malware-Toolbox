#pragma once
#include <xstring>

#include "Utils.h"

using namespace Collections::Generic;

namespace MalwareToolbox {
	namespace LibraryC {
		namespace Unpackers
		{
			public value struct Signature
			{
				String^ Tool;
				List<Byte>^ SignatureValues;
				List<Byte>^ SignatureWildCards;
				bool IsEP;
			};

			public ref class PackerDatabase : public Utils::File
			{
			public:
				PackerDatabase(String^ filePath);
				void PreprocessSignature(String^ line, Signature* signature);
				bool Load() override;

				List<Signature>^ GetSignatures();

			private:
				List<Signature>^ m_signatures;
			};
		}
	}
}
