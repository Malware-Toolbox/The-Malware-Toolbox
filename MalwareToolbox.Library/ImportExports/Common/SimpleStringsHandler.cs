namespace MalwareToolbox.Library.ImportExports.Common;

public class SimpleStringsHandler : IImportExportHandler<object>
{
    public string FileType => ".txt";
    public async Task<object?> Import(string path, StreamReader stream)
    {
        List<string> strings = new List<string>();
        while (!stream.EndOfStream)
        {
            strings.Add(await stream.ReadLineAsync() ?? string.Empty);
        }

        return strings;
    }

    public async Task<bool> Export(string path, StreamWriter stream, object? data)
    {
        if (data == null)
        {
            return false;
        }

        if (data is IEnumerable<string> strings)
        {
            foreach (var item in strings)
            {
                await stream.WriteLineAsync(item);
            }

            return true;
        }

        await stream.WriteLineAsync(data.ToString());

        return true;
    }
}
